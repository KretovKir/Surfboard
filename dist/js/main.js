!function(){var e=document.querySelector(".burger"),t=document.querySelector(".hidden"),n=document.querySelector(".cross");e.addEventListener("click",function(e){t.style.display="block",t.style.zIndex="1",t.style.overflow="hidden"}),n.addEventListener("click",function(e){t.style.display="none"}),t.addEventListener("click",e=>{e.preventDefault(),e.target.classList.contains("hidden__link")&&(t.style.display="none")})}(),function(){const o=e=>{var t=e.find(".menu__content"),n=t.find(".menu__content-utero"),o=(e=>{let t=524;var n=$(window).width(),e=e.closest(".menu__accord").find(".menu__item-title"),o=e.width()*e.length,a=(console.log(o),window.matchMedia("(max-width: 720px)").matches),i=window.matchMedia("(max-width: 480px)").matches;return a&&(t=n-o),t=i?n-e.width():t})(e);e.addClass("menu__item--active"),t.width(o),n.width(o)},a=e=>{var e=e.find(".menu__item"),t=e.find(".menu__content");e.removeClass("menu__item--active"),t.width(0)};$(".menu__item-title").on("click",e=>{e.preventDefault();var e=$(e.currentTarget),t=e.closest(".menu__item"),n=t.hasClass("menu__item--active"),e=e.closest(".menu__accord");n?a(e):(a(e),o(t))})}(),function(){let o;ymaps.ready(()=>{o=new ymaps.Map("map-block",{center:[69.165,35.14],zoom:14,controls:[]});for(var e=[[69.163907,35.146614],[69.167404,35.143657]],t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker.svg",iconImageSize:[30,42]}),n=0;n<e.length;n++)t.add(new ymaps.Placemark(e[n]));o.geoObjects.add(t),o.behaviors.disable("scrollZoom")})}(),$(".reviews__user").on("click",e=>{var n,e=$(e.currentTarget),t=e.attr("data-open"),t=(n=t,$(".reviews__content").filter((e,t)=>$(t).attr("data-open-with")==n));e.addClass("user-active").siblings().removeClass("user-active"),t.addClass("active").siblings().removeClass("active")}),function(){const o=$(".section"),n=$(".maincontent");o.first().addClass("active");var e=new MobileDetect(window.navigator.userAgent).mobile();let a=!1;const i=e=>{var t;!1===a&&(a=!0,t=-100*e,n.css({transform:`translateY(${t}%)`}),o.eq(e).addClass("active").siblings().removeClass("active"),$(".fixed__item").eq(e).addClass("fixed__item--active").siblings().removeClass("fixed__item--active"),setTimeout(()=>{a=!1},1300))},l=e=>{var t=o.filter(".active"),n=t.next(),t=t.prev();"next"===e&&n.length&&i(n.index()),"prev"===e&&t.length&&i(t.index())};$(window).on("wheel",e=>{e=e.originalEvent.deltaY;0<e&&l("next"),e<0&&l("prev")}),$(window).on("keydown",e=>{console.log(e.keyCode);var t=e.target.tagName.toLowerCase();if("input"!==t&&"textarea"!==t)switch(e.keyCode){case 38:l("prev");break;case 40:l("next")}}),$("[data-scroll-to]").on("click",e=>{e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$(`[data-section-id=${e}]`);console.log(e.index()),i(e.index())}),$(".wrapper").on("touchMove",e=>e.preventDefault()),e&&$("body").swipe({swipe:function(e,t){"up"===t&&l("next"),"down"===t&&l("prev")}})}(),function(){const t=$(".products__items").bxSlider({pager:!1,controls:!1});$(".products__control--left").click(e=>{e.preventDefault(),t.goToPrevSlide()}),$(".products__control--right").click(e=>{e.preventDefault(),t.goToNextSlide()})}(),function(){const o=e=>{var t=$(e).find(".team__item-drop");e.find(".team__item").removeClass("isActive"),$(t).height(0)};$(".team__item-title").on("click",e=>{var t,e=$(e.currentTarget),n=e.closest(".team__items");e.closest(".team__item").hasClass("isActive")?o(n):(o(n),n=e,n=$(n).closest(".team__item"),e=$(n).find(".team__item-drop"),t=$(n).find(".team__item-content"),t=$(t).height(),n.addClass("isActive"),$(e).height(t))})}(),function(){const r=document.getElementById("form");function d(e){if(e.checkValidity())return e.nextElementSibling.textContent="",1;e.nextElementSibling.textContent=e.validationMessage}sendBtn.addEventListener("click",e=>{if(e.preventDefault(),console.log("form1",r),function(e){let t=!0;d(e.elements.name)||(t=!1);d(e.elements.phone)||(t=!1);d(e.elements.comment)||(t=!1);d(e.elements.street)||(t=!1);d(e.elements.house)||(t=!1);d(e.elements.corpus)||(t=!1);d(e.elements.apartment)||(t=!1);d(e.elements.floor)||(t=!1);return t}(r)){console.log("ок");const r=$("#form");var e=r.find("[name = 'name']"),t=r.find("[name = 'phone']"),n=r.find("[name = 'street']"),o=r.find("[name = 'house']"),a=r.find("[name = 'corpus']"),i=r.find("[name = 'apartment']"),l=r.find("[name = 'floor']"),s=r.find("[name='to']"),c=r.find("[name='comment']");$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:e.val(),phone:t.val(),street:n.val(),house:o.val(),corpus:a.val(),apartment:i.val(),floor:l.val(),to:s.val(),comment:c.val()},success:e=>{console.log(e),$(".modal__text").text(e.message),$("#modal").css("overflow","hidden"),$.fancybox.open({src:"#modal",type:"inline"})},error:e=>{console.log(e),$(".modal__text").text("Произошла ошибка, попробуйте позже"),$.fancybox.open({src:"#modal",type:"inline"})}})}}),$(".app-close-modal").on("click",()=>{$.fancybox.close()})}(),function(){let a,i,l,s,c;document.addEventListener("DOMContentLoaded",e=>{a=document.getElementById("video"),l=document.getElementById("durationLevel"),s=document.getElementById("soundLevel"),i=document.querySelectorAll(".play"),s.addEventListener("click",o),s.addEventListener("mouseup",o),l.value=0,l.min=0,l.max=Math.round(a.duration),l.addEventListener("input",n);for(let e=0;e<i.length;e++)i[e].addEventListener("click",()=>{document.querySelector(".play-btn").classList.toggle("play-btn--active"),a.paused?(a.play(),c=setInterval(t,1e3/66)):(a.pause(),clearInterval(c))});function t(){l.value=a.currentTime}function n(){a.currentTime=l.value,c=setInterval(t,1e3/66)}function o(){a.volume=s.value/10}document.getElementById("micLevel").addEventListener("click",function(){0===a.volume?(a.volume=s).value=10*s:(s=a.volume,a.volume=0,s.value=0)})})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1cmdlci5qcyIsImhvcml6b250YWwuanMiLCJtYXAuanMiLCJyZXZpZXdzLmpzIiwic2Nyb2xsLmpzIiwic2xpZGVyLmpzIiwidGVhbS5qcyIsInZhbGlkYXRpb24uanMiLCJ2aWRlby5qcyJdLCJuYW1lcyI6WyJidXJnZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJoaWRkZW4iLCJjbG9zZUNyb3NzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwic3R5bGUiLCJkaXNwbGF5IiwiekluZGV4Iiwib3ZlcmZsb3ciLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIml0ZW1PcGVuIiwiaXRlbUNvbnRlbnQiLCJpdGVtIiwiZmluZCIsImNvbnRlbnRUZXh0Qm94IiwicmVxV2lkdGgiLCJsZXQiLCJ3aWR0aCIsInNjcmVlbldpZHRoIiwiJCIsIndpbmRvdyIsInRpdGxlc0Jsb2NrcyIsImNsb3Nlc3QiLCJ0aXRsZVdpZHRoIiwibGVuZ3RoIiwiaXNUYWJsZXQiLCJjb25zb2xlIiwibG9nIiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJpc1Bob25lIiwiYWRkQ2xhc3MiLCJjbG9zZUV2ZXJ5SXRlbSIsIm1lbnVJdGVtcyIsImNvbnRhaW5lciIsIml0ZW1zQ29udGVudCIsInJlbW92ZUNsYXNzIiwib24iLCIkdGhpcyIsImN1cnJlbnRUYXJnZXQiLCJpdGVtT3BlbmVkIiwiaGFzQ2xhc3MiLCJteU1hcCIsInltYXBzIiwicmVhZHkiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJjb29yZHMiLCJteUNvbGxlY3Rpb24iLCJHZW9PYmplY3RDb2xsZWN0aW9uIiwiZHJhZ2dhYmxlIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaSIsImFkZCIsIlBsYWNlbWFyayIsImdlb09iamVjdHMiLCJiZWhhdmlvcnMiLCJkaXNhYmxlIiwiYXR0ciIsInNob3dJdGVtIiwiZmlsdGVyIiwibmR4IiwiYWxpYXMiLCJzaWJsaW5ncyIsInNlY3Rpb25zIiwiZmlyc3QiLCJpc01vYmlsZSIsIk1vYmlsZURldGVjdCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm1vYmlsZSIsImluU2Nyb2xsIiwicGVyZm9ybVRyYW5zaXRpb24iLCJwb3NpdGlvbiIsInNlY3Rpb25FcSIsImNzcyIsInRyYW5zZm9ybSIsImVxIiwic2V0VGltZW91dCIsInNjcm9sbFZpZXdwb3J0IiwiYWN0aXZlU2VjdGlvbiIsIm5leHRTZWN0aW9uIiwibmV4dCIsInByZXZTZWN0aW9uIiwicHJldiIsImRpcmVjdGlvbiIsImluZGV4IiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsImtleUNvZGUiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJzbGlkZXIiLCJieFNsaWRlciIsInBhZ2VyIiwiY2xpY2siLCJnb1RvUHJldlNsaWRlIiwiZ29Ub05leHRTbGlkZSIsImNsb3NlQWxsIiwiYWxsQmxvY2tzIiwiaGVpZ2h0IiwiZHJvcENvbnRlbnQiLCJjbG9zZVNpYmxpbmdzIiwiZHJvcEVsZW0iLCJjdXJIZWlnaHQiLCJmb3JtIiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWxpZGF0ZUZpZWxkIiwiZmllbGQiLCJjaGVja1ZhbGlkaXR5IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNlbmRCdG4iLCJ2YWxpZCIsImVsZW1lbnRzIiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInN0cmVldCIsImhvdXNlIiwiY29ycHVzIiwiYXBhcnRtZW50IiwiZmxvb3IiLCJ0byIsImFqYXgiLCJ1cmwiLCJtZXRob2QiLCJkYXRhIiwidmFsIiwic3VjY2VzcyIsInRleHQiLCJtZXNzYWdlIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsImVycm9yIiwiY2xvc2UiLCJ2aWRlbyIsInBsYXkiLCJkdXJhdGlvbkNvbnRyb2wiLCJzb3VuZENvbnRyb2wiLCJpbnRlcnZhbElkIiwicXVlcnlTZWxlY3RvckFsbCIsImNoYW5nZVNvdW5kIiwidmFsdWUiLCJtaW4iLCJtYXgiLCJNYXRoIiwicm91bmQiLCJkdXJhdGlvbiIsInNldFZpZGVvRHVyYXRpb24iLCJ0b2dnbGUiLCJwYXVzZWQiLCJzZXRJbnRlcnZhbCIsInVwZGF0ZUR1cmF0aW9uIiwicGF1c2UiLCJjbGVhckludGVydmFsIiwiY3VycmVudFRpbWUiLCJ2b2x1bWUiXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsV0FDQSxJQUFBQSxFQUFBQyxTQUFBQyxjQUFBLFNBQUEsRUFDQUMsRUFBQUYsU0FBQUMsY0FBQSxTQUFBLEVBQ0FFLEVBQUFILFNBQUFDLGNBQUEsUUFBQSxFQUVBRixFQUFBSyxpQkFBQSxRQUFBLFNBQUFDLEdBQ0FILEVBQUFJLE1BQUFDLFFBQUEsUUFDQUwsRUFBQUksTUFBQUUsT0FBQSxJQUNBTixFQUFBSSxNQUFBRyxTQUFBLFFBQ0EsQ0FBQSxFQUVBTixFQUFBQyxpQkFBQSxRQUFBLFNBQUFDLEdBQ0FILEVBQUFJLE1BQUFDLFFBQUEsTUFDQSxDQUFBLEVBQ0FMLEVBQUFFLGlCQUFBLFFBQUEsSUFDQU0sRUFBQUMsZUFBQSxFQUVBRCxFQUFBRSxPQUFBQyxVQUFBQyxTQUFBLGNBQUEsSUFDQVosRUFBQUksTUFBQUMsUUFBQSxPQUVBLENBQUEsQ0FFQSxFQUFBLEVDdEJBLFdBQ0EsTUF1QkFRLEVBQUEsSUFDQSxJQUFBQyxFQUFBQyxFQUFBQyxLQUFBLGdCQUFBLEVBQ0FDLEVBQUFILEVBQUFFLEtBQUEsc0JBQUEsRUFFQUUsR0EzQkFILElBQ0FJLElBQUFDLEVBQUEsSUFDQSxJQUFBQyxFQUFBQyxFQUFBQyxNQUFBLEVBQUFILE1BQUEsRUFFQUksRUFEQVQsRUFBQVUsUUFBQSxlQUFBLEVBQ0FULEtBQUEsbUJBQUEsRUFDQVUsRUFBQUYsRUFBQUosTUFBQSxFQUFBSSxFQUFBRyxPQUlBQyxHQUZBQyxRQUFBQyxJQUFBSixDQUFBLEVBRUFILE9BQUFRLFdB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QUksTUFBQSxFQUVBLENBWkEsQ0FtQ0EsQ0FBQSxDQUNBLEVBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe1xyXG4gIHZhciBidXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1cmdlclwiKTtcclxuICB2YXIgaGlkZGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oaWRkZW5cIik7XHJcbiAgdmFyIGNsb3NlQ3Jvc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNyb3NzXCIpO1xyXG4gIFxyXG4gIGJ1cmdlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBoaWRkZW4uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgIGhpZGRlbi5zdHlsZS56SW5kZXggPSBcIjFcIjtcclxuICAgIGhpZGRlbi5zdHlsZS5vdmVyZmxvdz1cImhpZGRlblwiO1xyXG4gIH0pO1xyXG4gIFxyXG4gIGNsb3NlQ3Jvc3MuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgaGlkZGVuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICB9KTtcclxuICBoaWRkZW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuX19saW5rJykpIHtcclxuICAgICAgaGlkZGVuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH1cclxuICB9KVxyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuICBjb25zdCBtZXN1cmVXaWR0aCA9IGl0ZW0gPT57XHJcbiAgICBsZXQgd2lkdGggPSA1MjQ7XHJcbiAgICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KCcubWVudV9fYWNjb3JkJyk7XHJcbiAgICBjb25zdCB0aXRsZXNCbG9ja3MgPWNvbnRhaW5lci5maW5kKCcubWVudV9faXRlbS10aXRsZScpO1xyXG4gICAgY29uc3QgdGl0bGVXaWR0aCA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpICogdGl0bGVzQmxvY2tzLmxlbmd0aDsgXHJcbiAgXHJcbiAgICBjb25zb2xlLmxvZyh0aXRsZVdpZHRoKTtcclxuICBcclxuICAgIGNvbnN0IGlzVGFibGV0ID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDcyMHB4KScpLm1hdGNoZXM7XHJcbiAgICBjb25zdCBpc1Bob25lID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDQ4MHB4KScpLm1hdGNoZXM7XHJcbiAgXHJcbiAgICBpZiAoaXNUYWJsZXQpe1xyXG4gICAgICB3aWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVXaWR0aDtcclxuICAgIH1cclxuICBcclxuICAgIGlmKGlzUGhvbmUpe1xyXG4gICAgICB3aWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzQmxvY2tzLndpZHRoKClcclxuICAgIH1cclxuICAgIHJldHVybiB3aWR0aDtcclxuICBcclxuICB9XHJcbiAgXHJcbiAgY29uc3QgaXRlbU9wZW4gPSAoaXRlbSkgPT4ge1xyXG4gICAgY29uc3QgaXRlbUNvbnRlbnQgPSBpdGVtLmZpbmQoJy5tZW51X19jb250ZW50Jyk7XHJcbiAgICBjb25zdCBjb250ZW50VGV4dEJveCA9IGl0ZW1Db250ZW50LmZpbmQoJy5tZW51X19jb250ZW50LXV0ZXJvJyk7XHJcbiAgXHJcbiAgICBjb25zdCByZXFXaWR0aCA9IG1lc3VyZVdpZHRoKGl0ZW0pO1xyXG4gICAgaXRlbS5hZGRDbGFzcygnbWVudV9faXRlbS0tYWN0aXZlJyk7XHJcbiAgICBpdGVtQ29udGVudC53aWR0aChyZXFXaWR0aCk7XHJcbiAgICBjb250ZW50VGV4dEJveC53aWR0aChyZXFXaWR0aCk7XHJcbiAgfTtcclxuICBcclxuICBjb25zdCBjbG9zZUV2ZXJ5SXRlbSA9IChjb250YWluZXIpID0+IHtcclxuICAgIGNvbnN0IG1lbnVJdGVtcyA9IGNvbnRhaW5lci5maW5kKCcubWVudV9faXRlbScpO1xyXG4gICAgY29uc3QgaXRlbXNDb250ZW50ID0gbWVudUl0ZW1zLmZpbmQoJy5tZW51X19jb250ZW50Jyk7XHJcbiAgXHJcbiAgICBtZW51SXRlbXMucmVtb3ZlQ2xhc3MoJ21lbnVfX2l0ZW0tLWFjdGl2ZScpO1xyXG4gICAgaXRlbXNDb250ZW50LndpZHRoKDApO1xyXG4gIH07XHJcbiAgXHJcbiAgJChcIi5tZW51X19pdGVtLXRpdGxlXCIpLm9uKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbGV0ICR0aGlzID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGxldCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5tZW51X19pdGVtXCIpO1xyXG4gICAgbGV0IGl0ZW1PcGVuZWQgPSBpdGVtLmhhc0NsYXNzKCdtZW51X19pdGVtLS1hY3RpdmUnKTtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoJy5tZW51X19hY2NvcmQnKVxyXG4gIFxyXG4gICAgaWYgKGl0ZW1PcGVuZWQpIHtcclxuICAgICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgICAgIGl0ZW1PcGVuKGl0ZW0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIFxyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG4gIGxldCBteU1hcDtcclxuXHJcbmNvbnN0IGluaXQgPSAoKSA9PiB7XHJcbiAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwLWJsb2NrXCIsIHtcclxuICAgIGNlbnRlcjogWzY5LjE2NSwgMzUuMTRdLFxyXG4gICAgem9vbTogMTQsXHJcbiAgICBjb250cm9sczogW10sXHJcbiAgICBcclxuICB9KTtcclxuXHJcbiAgY29uc3QgY29vcmRzID0gW1xyXG4gICAgWzY5LjE2MzkwNywgMzUuMTQ2NjE0XSxcclxuICAgIFs2OS4xNjc0MDQsIDM1LjE0MzY1N10sXHJcbiAgXTtcclxuXHJcbiAgY29uc3QgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oXHJcbiAgICB7fSxcclxuICAgIHtcclxuICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgICAgaWNvbkxheW91dDogXCJkZWZhdWx0I2ltYWdlXCIsXHJcbiAgICAgIGljb25JbWFnZUhyZWY6IFwiLi9pbWcvbWFya2VyLnN2Z1wiLFxyXG4gICAgICBpY29uSW1hZ2VTaXplOiBbMzAsIDQyXSxcclxuICAgICAgXHJcbiAgICAvLyAgIGljb25JbWFnZU9mZnNldDogWy0zLCAtNDJdLFxyXG4gICAgfVxyXG4gICk7XHJcblxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmRzW2ldKSk7XHJcbiAgfVxyXG5cclxuICBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pO1xyXG4gIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XHJcbn07XHJcblxyXG55bWFwcy5yZWFkeShpbml0KTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcbiAgICBjb25zdCBmaW5kQmxvY2sgPSAoYWxpYXMpPT57XHJcbiAgICAgICAgcmV0dXJuICQoJy5yZXZpZXdzX19jb250ZW50JykuZmlsdGVyKChuZHgsIGl0ZW0pPT57XHJcbiAgICAgICAgICAgICByZXR1cm4gJChpdGVtKS5hdHRyKCdkYXRhLW9wZW4td2l0aCcpPT1hbGlhcztcclxuICAgICAgICAgfSlcclxuICAgICB9XHJcbiAgICAgXHJcbiAgICAgXHJcbiAgICAgJCgnLnJldmlld3NfX3VzZXInKS5vbignY2xpY2snLCAoZXZlbnQpPT57XHJcbiAgICAgICAgIGxldCAkdGhpcyA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XHJcbiAgICAgICAgIGxldCB0YXJnZXQgPSAkdGhpcy5hdHRyKCdkYXRhLW9wZW4nKTtcclxuICAgICAgICAgbGV0IHNob3dJdGVtID0gZmluZEJsb2NrKHRhcmdldCk7XHJcbiAgICAgICAgICR0aGlzLmFkZENsYXNzKCd1c2VyLWFjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ3VzZXItYWN0aXZlJyk7XHJcbiAgICAgICAgIHNob3dJdGVtLmFkZENsYXNzKCdhY3RpdmUnKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICB9KVxyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG4gIGNvbnN0IHNlY3Rpb25zID0gJChcIi5zZWN0aW9uXCIpO1xyXG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluY29udGVudFwiKTtcclxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuY29uc3QgbW9iaWxlRGV0ZWN0ID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbmNvbnN0IGlzTW9iaWxlID0gbW9iaWxlRGV0ZWN0Lm1vYmlsZSgpO1xyXG5cclxubGV0IGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG5cclxuXHJcbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gICAgaWYoaW5TY3JvbGw9PT1mYWxzZSl7XHJcbiAgICAgICAgaW5TY3JvbGw9dHJ1ZTtcclxuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XHJcbiAgICAgICAgZGlzcGxheS5jc3Moe1xyXG4gICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYCxcclxuICAgICAgICB9KTtcclxuICAgICAgICBzZWN0aW9ucy5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgJCgnLmZpeGVkX19pdGVtJykuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcygnZml4ZWRfX2l0ZW0tLWFjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2ZpeGVkX19pdGVtLS1hY3RpdmUnKTtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgICAgICAgIGluU2Nyb2xsPWZhbHNlO1xyXG4gICAgICAgIH0sMTMwMClcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IHNjcm9sbFZpZXdwb3J0ID0gKGRpcmVjdGlvbikgPT4ge1xyXG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xyXG4gIGNvbnN0IG5leHRTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5uZXh0KCk7XHJcbiAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcclxuXHJcbiAgaWYgKGRpcmVjdGlvbiA9PT0gXCJuZXh0XCIgJiYgbmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgIHBlcmZvcm1UcmFuc2l0aW9uKG5leHRTZWN0aW9uLmluZGV4KCkpO1xyXG4gIH1cclxuICBpZiAoZGlyZWN0aW9uID09PSBcInByZXZcIiAmJiBwcmV2U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuICAgIH1cclxufTtcclxuXHJcbiQod2luZG93KS5vbihcIndoZWVsXCIsIChldmVudCkgPT4ge1xyXG4gIGNvbnN0IGRlbHRhWSA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gIGlmIChkZWx0YVkgPiAwKSB7XHJcbiAgICAvL25leHRcclxuICAgIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKTtcclxuICB9XHJcbiAgaWYgKGRlbHRhWSA8IDApIHtcclxuICAgIC8vcHJldlxyXG4gICAgc2Nyb2xsVmlld3BvcnQoXCJwcmV2XCIpO1xyXG4gIH1cclxuXHJcbn0pO1xyXG5cclxuJCh3aW5kb3cpLm9uKCdrZXlkb3duJywgZXZlbnQgPT57XHJcbiAgICBjb25zb2xlLmxvZyhldmVudC5rZXlDb2RlKVxyXG4gICAgbGV0IHRhZ05hbWUgPSBldmVudC50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgaWYodGFnTmFtZSE9PSdpbnB1dCcgJiYgdGFnTmFtZSE9PSd0ZXh0YXJlYScpe1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xyXG4gICAgICAgICAgICBjYXNlIDM4OlxyXG4gICAgICAgICAgICBzY3JvbGxWaWV3cG9ydChcInByZXZcIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICBcclxuICAgICAgICAgICAgY2FzZSA0MDpcclxuICAgICAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJuZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KVxyXG5cclxuXHJcblxyXG5cclxuJCgnW2RhdGEtc2Nyb2xsLXRvXScpLm9uKCdjbGljaycsIGV2ZW50PT57XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgJHRoaXMgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cignZGF0YS1zY3JvbGwtdG8nKTtcclxuICAgIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcclxuICAgIGNvbnNvbGUubG9nKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xyXG59KVxyXG5cclxuXHJcbi8vICQoJy5maXhlZF9faXRlbScpLm9uKCdjbGljaycsIGV2ZW50ID0+e1xyXG4vLyAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbi8vICAgICBjb25zdCAkdGhpcyA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XHJcbi8vICAgICAkdGhpcy5hZGRDbGFzcygnZml4ZWRfX2l0ZW0tLWFjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2ZpeGVkX19pdGVtLS1hY3RpdmUnKTtcclxuLy8gICAgIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoJ2RhdGEtc2Nyb2xsLXRvJyk7XHJcbi8vICAgICBjb25zdCByZXFTZWN0aW9uID0gJChgW2RhdGEtc2VjdGlvbi1pZD0ke3RhcmdldH1dYCk7XHJcbi8vICAgICBjb25zb2xlLmxvZyhyZXFTZWN0aW9uLmluZGV4KCkpO1xyXG4vLyAgICAgcGVyZm9ybVRyYW5zaXRpb24ocmVxU2VjdGlvbi5pbmRleCgpKTtcclxuLy8gfSlcclxuXHJcblxyXG5cclxuJCgnLndyYXBwZXInKS5vbigndG91Y2hNb3ZlJywgZXZlbnQgPT4gZXZlbnQucHJldmVudERlZmF1bHQoKSk7XHJcblxyXG5pZiAoaXNNb2JpbGUpIHtcclxuICBcclxuICAkKFwiYm9keVwiKS5zd2lwZSh7XHJcbiAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3VwJykge1xyXG4gICAgICAgIHNjcm9sbFZpZXdwb3J0KCduZXh0JylcclxuICAgICAgfVxyXG4gICAgICBpZiAoZGlyZWN0aW9uID09PSAnZG93bicpIHtcclxuICAgICAgICBzY3JvbGxWaWV3cG9ydCgncHJldicpXHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuICAgIGNvbnN0IHNsaWRlciA9ICQoXCIucHJvZHVjdHNfX2l0ZW1zXCIpLmJ4U2xpZGVyKHtcclxuICAgICAgICBwYWdlcjogZmFsc2UsXHJcbiAgICAgICAgY29udHJvbHM6IGZhbHNlXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgJCgnLnByb2R1Y3RzX19jb250cm9sLS1sZWZ0JykuY2xpY2soZT0+e1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBzbGlkZXIuZ29Ub1ByZXZTbGlkZSgpO1xyXG4gICAgfSlcclxuICAgIFxyXG4gICAgXHJcbiAgICAkKCcucHJvZHVjdHNfX2NvbnRyb2wtLXJpZ2h0JykuY2xpY2soZT0+e1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xyXG4gICAgfSlcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuICAgIGNvbnN0IGlzT3BlbiA9IGl0ZW0gPT57XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gJChpdGVtKS5jbG9zZXN0KCcudGVhbV9faXRlbScpO1xyXG4gICAgICAgIGNvbnN0IGRyb3BFbGVtID0gJChjb250YWluZXIpLmZpbmQoJy50ZWFtX19pdGVtLWRyb3AnKTsgXHJcbiAgICAgICAgY29uc3QgZHJvcENvbnRlbnQgPSAkKGNvbnRhaW5lcikuZmluZCgnLnRlYW1fX2l0ZW0tY29udGVudCcpO1xyXG4gICAgICAgIGNvbnN0IGN1ckhlaWdodCA9ICQoZHJvcENvbnRlbnQpLmhlaWdodCgpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hZGRDbGFzcygnaXNBY3RpdmUnKTtcclxuICAgICAgICAkKGRyb3BFbGVtKS5oZWlnaHQoY3VySGVpZ2h0KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgY2xvc2VBbGwgPSBjb250YWluZXIgPT57XHJcbiAgICAgICAgY29uc3QgYWxsQmxvY2tzID0gJChjb250YWluZXIpLmZpbmQoJy50ZWFtX19pdGVtLWRyb3AnKTtcclxuICAgICAgICBjb25zdCBpdGVtQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoJy50ZWFtX19pdGVtJyk7XHJcbiAgICAgICAgaXRlbUNvbnRhaW5lci5yZW1vdmVDbGFzcygnaXNBY3RpdmUnKTtcclxuICAgICAgICAkKGFsbEJsb2NrcykuaGVpZ2h0KDApO1xyXG4gICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgICQoJy50ZWFtX19pdGVtLXRpdGxlJykub24oJ2NsaWNrJywgKGV2ZW50KT0+e1xyXG4gICAgICAgIGNvbnN0ICR0aGlzID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBjbG9zZVNpYmxpbmdzID0gJHRoaXMuY2xvc2VzdCgnLnRlYW1fX2l0ZW1zJyk7XHJcbiAgICAgICAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoJy50ZWFtX19pdGVtJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoZWxlbUNvbnRhaW5lci5oYXNDbGFzcygnaXNBY3RpdmUnKSl7XHJcbiAgICAgICAgICAgIGNsb3NlQWxsKGNsb3NlU2libGluZ3MpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjbG9zZUFsbChjbG9zZVNpYmxpbmdzKTtcclxuICAgICAgICAgICAgaXNPcGVuKCR0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtJyk7XHJcblxyXG5zZW5kQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnNvbGUubG9nKCdmb3JtMScsZm9ybSlcclxuICBpZiAodmFsaWRhdGVGb3JtKGZvcm0pKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcItC+0LpcIik7XHJcblxyXG4gICAgY29uc3QgZm9ybSA9ICQoJyNmb3JtJyk7XHJcbiAgICBjb25zdCBuYW1lID0gZm9ybS5maW5kKFwiW25hbWUgPSAnbmFtZSddXCIpO1xyXG4gICAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoXCJbbmFtZSA9ICdwaG9uZSddXCIpO1xyXG4gICAgY29uc3Qgc3RyZWV0ID0gZm9ybS5maW5kKFwiW25hbWUgPSAnc3RyZWV0J11cIik7XHJcbiAgICBjb25zdCBob3VzZSA9IGZvcm0uZmluZChcIltuYW1lID0gJ2hvdXNlJ11cIik7XHJcbiAgICBjb25zdCBjb3JwdXMgPSBmb3JtLmZpbmQoXCJbbmFtZSA9ICdjb3JwdXMnXVwiKTtcclxuICAgIGNvbnN0IGFwYXJ0bWVudCA9IGZvcm0uZmluZChcIltuYW1lID0gJ2FwYXJ0bWVudCddXCIpO1xyXG4gICAgY29uc3QgZmxvb3IgPSBmb3JtLmZpbmQoXCJbbmFtZSA9ICdmbG9vciddXCIpO1xyXG4gICAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcclxuICAgIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xyXG5cclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogXCJodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWxcIixcclxuICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIG5hbWU6IG5hbWUudmFsKCksXHJcbiAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgIHN0cmVldDogc3RyZWV0LnZhbCgpLFxyXG4gICAgICAgIGhvdXNlOiBob3VzZS52YWwoKSxcclxuICAgICAgICBjb3JwdXM6IGNvcnB1cy52YWwoKSxcclxuICAgICAgICBhcGFydG1lbnQ6IGFwYXJ0bWVudC52YWwoKSxcclxuICAgICAgICBmbG9vcjogZmxvb3IudmFsKCksXHJcbiAgICAgICAgdG86IHRvLnZhbCgpLFxyXG4gICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQudmFsKClcclxuICAgICAgfSxcclxuICAgICAgc3VjY2VzczogKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAkKCcubW9kYWxfX3RleHQnKS50ZXh0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgICAgJCgnI21vZGFsJykuY3NzKCdvdmVyZmxvdycsJ2hpZGRlbicpO1xyXG4gICAgICAgICQuZmFuY3lib3gub3Blbih7XHJcbiAgICAgICAgICBzcmM6IFwiI21vZGFsXCIsXHJcbiAgICAgICAgICB0eXBlOiBcImlubGluZVwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG4gICAgICBlcnJvcjogKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAkKCcubW9kYWxfX3RleHQnKS50ZXh0KCfQn9GA0L7QuNC30L7RiNC70LAg0L7RiNC40LHQutCwLCDQv9C+0L/RgNC+0LHRg9C50YLQtSDQv9C+0LfQttC1Jyk7XHJcbiAgICAgICAgJC5mYW5jeWJveC5vcGVuKHtcclxuICAgICAgICAgIHNyYzogXCIjbW9kYWxcIixcclxuICAgICAgICAgIHR5cGU6IFwiaW5saW5lXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZUZvcm0oZm9ybSkge1xyXG4gIGxldCB2YWxpZCA9IHRydWU7XHJcblxyXG4gIGlmICghdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLm5hbWUpKSB7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG4gIH1cclxuICBpZiAoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy5waG9uZSkpIHtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgfVxyXG4gIGlmICghdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLmNvbW1lbnQpKXtcclxuICAgIHZhbGlkPWZhbHNlO1xyXG4gIH1cclxuICBpZiAoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy5zdHJlZXQpKXtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbn07XHJcbmlmICghdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLmhvdXNlKSl7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG59O1xyXG5pZiAoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy5jb3JwdXMpKXtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbn07XHJcbmlmICghdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLmFwYXJ0bWVudCkpe1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxufTtcclxuaWYgKCF2YWxpZGF0ZUZpZWxkKGZvcm0uZWxlbWVudHMuZmxvb3IpKXtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbn07XHJcbiAgcmV0dXJuIHZhbGlkO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7XHJcbiAgaWYgKCFmaWVsZC5jaGVja1ZhbGlkaXR5KCkpIHtcclxuICAgIGZpZWxkLm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudCA9IGZpZWxkLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBmaWVsZC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuXHJcbiQoJy5hcHAtY2xvc2UtbW9kYWwnKS5vbignY2xpY2snLCAoKSA9PiB7XHJcbiAgJC5mYW5jeWJveC5jbG9zZSgpXHJcbn0pO1xyXG5cclxuXHJcbi8vICQoXCIjZm9ybVwiKS5vbihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuLy8gICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuLy8gICBjb25zdCBmb3JtID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcclxuLy8gICBjb25zdCBuYW1lID0gZm9ybS5maW5kKFwiW25hbWUgPSAnbmFtZSddXCIpO1xyXG4vLyAgIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWUgPSAncGhvbmUnXVwiKTtcclxuLy8gICBjb25zdCBzdHJlZXQgPSBmb3JtLmZpbmQoXCJbbmFtZSA9ICdzdHJlZXQnXVwiKTtcclxuLy8gICBjb25zdCBob3VzZSA9IGZvcm0uZmluZChcIltuYW1lID0gJ2hvdXNlJ11cIik7XHJcbi8vICAgY29uc3QgY29ycHVzID0gZm9ybS5maW5kKFwiW25hbWUgPSAnY29ycHVzJ11cIik7XHJcbi8vICAgY29uc3QgYXBhcnRtZW50ID0gZm9ybS5maW5kKFwiW25hbWUgPSAnYXBhcnRtZW50J11cIik7XHJcbi8vICAgY29uc3QgZmxvb3IgPSBmb3JtLmZpbmQoXCJbbmFtZSA9ICdmbG9vciddXCIpO1xyXG4vLyAgIGNvbnN0IHRvID0gZm9ybS5maW5kKFwiW25hbWU9J3RvJ11cIik7XHJcblxyXG4vLyAgICQuYWpheCh7XHJcbi8vICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbi8vICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4vLyAgICAgZGF0YToge1xyXG4vLyAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4vLyAgICAgICBwaG9uZTogcGhvbmUudmFsKCksXHJcbi8vICAgICAgIHN0cmVldDogc3RyZWV0LnZhbCgpLFxyXG4vLyAgICAgICBob3VzZTogaG91c2UudmFsKCksXHJcbi8vICAgICAgIGNvcnB1czogY29ycHVzLnZhbCgpLFxyXG4vLyAgICAgICBhcGFydG1lbnQ6IGFwYXJ0bWVudC52YWwoKSxcclxuLy8gICAgICAgZmxvb3I6IGZsb29yLnZhbCgpLFxyXG4vLyAgICAgICB0bzogdG8udmFsKCksXHJcbi8vICAgICB9LFxyXG4vLyAgIH0pO1xyXG4vLyB9KTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcbiAgbGV0IHZpZGVvO1xyXG5sZXQgcGxheTtcclxubGV0IGR1cmF0aW9uQ29udHJvbDtcclxubGV0IHNvdW5kQ29udHJvbDtcclxubGV0IGludGVydmFsSWQ7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoZXZlbnQpID0+IHtcclxuICB2aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9cIik7XHJcbiAgZHVyYXRpb25Db250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkdXJhdGlvbkxldmVsXCIpO1xyXG4gIHNvdW5kQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic291bmRMZXZlbFwiKTtcclxuICBwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wbGF5XCIpO1xyXG5cclxuICBzb3VuZENvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaGFuZ2VTb3VuZCk7XHJcbiAgc291bmRDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBjaGFuZ2VTb3VuZCk7XHJcblxyXG4gIGR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IDA7XHJcbiAgZHVyYXRpb25Db250cm9sLm1pbj0wO1xyXG4gIGR1cmF0aW9uQ29udHJvbC5tYXggPSBNYXRoLnJvdW5kKHZpZGVvLmR1cmF0aW9uKTtcclxuXHJcbiAgXHJcbiAgZHVyYXRpb25Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgc2V0VmlkZW9EdXJhdGlvbik7XHJcblxyXG4gIGZ1bmN0aW9uIG1vdXNlVXAoKXtcclxuICAgIHNldFZpZGVvRHVyYXRpb24oKTtcclxuICAgIHZpZGVvLnBsYXkoKTtcclxuICB9XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGk8cGxheS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgcGxheVtpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCk9PntcclxuXHJcbiAgICAgICAgICBsZXQgcGxheUltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5LWJ0bicpO1xyXG4gICAgICAgICAgcGxheUltZy5jbGFzc0xpc3QudG9nZ2xlKCdwbGF5LWJ0bi0tYWN0aXZlJyk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICBpZiAodmlkZW8ucGF1c2VkKSB7XHJcbiAgICAgICAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgICAgICAgICAgaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKHVwZGF0ZUR1cmF0aW9uLDEwMDAvNjYpXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsSWQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICl9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlRHVyYXRpb24oKXtcclxuICAgICAgZHVyYXRpb25Db250cm9sLnZhbHVlID0gdmlkZW8uY3VycmVudFRpbWU7XHJcbiAgICB9IFxyXG5cclxuICAgIGxldCBtaWNDb250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pY0xldmVsJyk7XHJcbiAgICBtaWNDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc291bmRPZmYpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNvdW5kT2ZmKCl7XHJcbiAgICAgIGlmKHZpZGVvLnZvbHVtZSA9PT0gMCl7XHJcbiAgICAgICAgdmlkZW8udm9sdW1lID0gc291bmRDb250cm9sOyBcclxuICAgICAgICBzb3VuZENvbnRyb2wudmFsdWUgPSBzb3VuZENvbnRyb2wgKjEwO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2V7XHJcbiAgICAgICAgc291bmRDb250cm9sPXZpZGVvLnZvbHVtZTtcclxuICAgICAgICB2aWRlby52b2x1bWUgPSAwO1xyXG4gICAgICAgIHNvdW5kQ29udHJvbC52YWx1ZT0wO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc3RvcEludGVydmFsKCl7XHJcbiAgICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2V0VmlkZW9EdXJhdGlvbigpe1xyXG4gICAgICAvLyBpZih2aWRlby5wYXVzZWQpe1xyXG4gICAgICAvLyAgIHZpZGVvLnBsYXkoKTtcclxuXHJcbiAgICAgIC8vIH1lbHNle1xyXG4gICAgICAvLyAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICAgIC8vIH1cclxuXHJcbiAgICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gZHVyYXRpb25Db250cm9sLnZhbHVlO1xyXG4gICAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodXBkYXRlRHVyYXRpb24sIDEwMDAvNjYpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNoYW5nZVNvdW5kKCl7XHJcbiAgICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kQ29udHJvbC52YWx1ZS8xMDtcclxuICAgIH1cclxuXHJcbn0pO1xyXG59KSgpOyJdfQ==
